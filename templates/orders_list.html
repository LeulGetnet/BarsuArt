{% extends 'base.html'%}
{% load static %}
{% block content %}
<section id="previous-orders" class="container my-5">
    <h2 class="text-center mb-4">{{title}}</h2>
    <div class="row">
        <!-- Order 1 -->
         {%for item in originals%}
        <div class="col-md-4 mb-4 artwork-item" data-index="{{forloop.counter}}">
            <a href="{% url 'detail' item.original.id %}">
            <div class="order-photo position-relative">
                <img src="{{item.latest_image.image.url}}" alt="Order 1" class="img-fluid">
                <div class="description position-absolute top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center text-white">
                    <p class="text-center">{{item.original.title}}</p>
                </div>

            </div>
        </a>
        </div>
        {%endfor%}
        <!-- Order 2 -->
    </div>
</section>

<script>
// Blur effect based on viewport visibility
document.addEventListener('DOMContentLoaded', function() {
    const artworkItems = document.querySelectorAll('.artwork-item');
    
    if (artworkItems.length === 0) return;
    
    // Check if item is fully visible in viewport
    function isFullyVisible(element) {
        const rect = element.getBoundingClientRect();
        const windowHeight = window.innerHeight || document.documentElement.clientHeight;
        
        // Element is fully visible if its top and bottom are within viewport
        return (
            rect.top >= 0 &&
            rect.bottom <= windowHeight
        );
    }
    
    // Apply blur based on visibility
    function updateBlurEffect() {
        artworkItems.forEach(item => {
            if (isFullyVisible(item)) {
                item.classList.remove('blurred');
                item.classList.add('visible');
            } else {
                item.classList.add('blurred');
                item.classList.remove('visible');
            }
        });
    }
    
    // Run on page load
    updateBlurEffect();
    
    // Run on scroll with throttle for performance
    let scrollTimeout;
    window.addEventListener('scroll', function() {
        if (scrollTimeout) {
            clearTimeout(scrollTimeout);
        }
        scrollTimeout = setTimeout(updateBlurEffect, 50);
    });
    
    // Run on window resize
    window.addEventListener('resize', updateBlurEffect);
});
</script>
{% endblock %}